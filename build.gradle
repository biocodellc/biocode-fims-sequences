buildscript {
    repositories {
        maven {
            url "http://repo.biocodellc.com/repository/maven-private/"
            credentials {
                username mavenUser
                password mavenPass
            }
        }
        mavenLocal()
    }
    dependencies {
        classpath "org.biocode:gradle-fims:1.1.5"
    }
}

apply plugin: "org.biocode.fims-app"

ext.fimsCommonsVersion = "0.2.1"
ext.fimsFusekiVersion = "0.3.0"

fims {
    maven {
        username mavenUser
        password mavenPass
    }
}

repositories {
    add(fims.mavenFims())
    mavenLocal()
}

// need to evaluate childProjects first so we can add the childProject server dependencies to the server configuration
evaluationDependsOnChildren()

dependencies {
    server 'org.apache.jena:jena-arq:2.9.1'
    server 'com.googlecode.json-simple:json-simple:1.1.1'
    server group: 'org.springframework', name: 'spring-context', version: '4.3.4.RELEASE'
    server 'commons-lang:commons-lang:2.6'
    server group: 'org.elasticsearch.client', name: 'transport', version: '5.0.0'

    server group: 'org.glassfish.jersey.media', name: 'jersey-media-moxy', version: '2.25'
    server('org.glassfish.jersey.ext:jersey-spring3:2.25') {
        exclude module: 'bean-validator'
        exclude module: 'asm-all-repackaged'
    }

    server group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: '2.8.4'

    // required for elasticsearch
    server group: 'org.apache.logging.log4j', name: 'log4j-to-slf4j', version: '2.7'

    compile composite.resolveDependency("org.biocode:biocode-fims-commons:${fimsCommonsVersion}", "biocode-fims-commons")
    compile composite.resolveDependency("org.biocode:biocode-fims-fuseki:${fimsFusekiVersion}", "biocode-fims-fuseki")

    testCompile "junit:junit-dep:4.10"
    testCompile 'org.mockito:mockito-all:1.9.5'

    subprojects.each {
        project.configurations.server.dependencies.addAll(it.configurations.server.dependencies)
        project.configurations.serverRuntime.dependencies.addAll(it.configurations.serverRuntime.dependencies)
    }
}
